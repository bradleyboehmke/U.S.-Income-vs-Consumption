xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, nudge_x = 1) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, nudge_x = .1) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text_repel(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text_repel(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, nudge_y = -.5) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text_repel(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, nudge_y = -.01) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, vjust = 0) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, hjust = .2) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, hjust = .3) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, hjust = .1) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, hjust = .01) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, hjust = 0) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text_repel(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text_repel(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, nudge_x = .5) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text_repel(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, nudge_x = .25) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text_repel(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, nudge_x = .3) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text_repel(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, nudge_x = .4) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text_repel(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, nudge_x = .2) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text_repel(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, hjust = 0) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, hjust = 1) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .2, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, hjust = 1) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .1, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, hjust = 1) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
ggplot(changes, aes(Metric, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = .1, alpha = .5) +
geom_text(data = filter(changes, Value > 1.1 | Value < .6), aes(label = Location), size = 3, hjust = 0) +
facet_wrap(~ Group) +
scale_y_continuous("Percent change from 1997 to 2014", labels = scales::percent) +
xlab(NULL) +
ggtitle("Figure 5: Percent change in PCE & PCI",
subtitle = "Comparing the change in PCE & PCI from 1997 to 2014 for those states with above versus below average savings rates") +
theme_bw() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
strip.text.x = element_text(size = 14),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
changes
changes %>% group_by(Group, Metric) %>% summarise(mean(Value))
data_clean %>%
filter(Location == "United States") %>%
ggplot(aes(x = Year)) +
geom_line(aes(y = Income, group = 1), color = "darkseagreen4") +
geom_line(aes(y = Expenditures, group = 1), color = "firebrick3") +
geom_ribbon(aes(ymin = Expenditures, ymax = Income, group = 1), fill = "darkseagreen1", alpha = .5) +
annotate("text", x = 2014.25, y = 40471, label = "2014 PCI: $40.5K", color = "darkseagreen4", hjust = 0) +
annotate("text", x = 2014.25, y = 37196, label = "2014 PCE: $37.2K", color = "firebrick3", hjust = 0) +
annotate("text", x = 2014.25, y = 38833.5, label = "2014 Savings: $3.3K", color = "darkseagreen2", hjust = 0) +
scale_x_continuous(NULL, limits = c(1997, 2016), breaks = seq(1998, 2014, by = 4)) +
scale_y_continuous("Current Year Dollars", labels = scales::dollar) +
ggtitle("Figure 1: Growth in PCI and PCE over time",
subtitle = "Temporal assessment of national-level growth rates (1997-2014)") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia"),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
data_clean %>%
filter(Location == "United States") %>%
ggplot(aes(x = Year)) +
geom_line(aes(y = Income, group = 1), color = "darkseagreen4") +
geom_line(aes(y = Expenditures, group = 1), color = "firebrick3") +
geom_ribbon(aes(ymin = Expenditures, ymax = Income, group = 1), fill = "darkseagreen1", alpha = .5) +
annotate("text", x = 2014.25, y = 40471, label = "2014 PCI: $40.5K", color = "darkseagreen4", hjust = 0) +
annotate("text", x = 2014.25, y = 37196, label = "2014 PCE: $37.2K", color = "firebrick3", hjust = 0) +
annotate("text", x = 2014.25, y = 38833.5, label = "2014 Savings: $3.3K", color = "darkseagreen2", hjust = 0) +
scale_x_continuous(NULL, limits = c(1997, 2016), breaks = seq(1998, 2014, by = 4)) +
scale_y_continuous("Current Year Dollars", labels = scales::dollar) +
ggtitle("Figure 1: Growth in PCI and PCE over time",
subtitle = "Temporal assessment of national-level growth rates (1997-2014)") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia"),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
data_clean %>%
filter(Location == "United States") %>%
mutate(Savings_Rate = Savings / Income) %>%
ggplot(aes(Year, Savings_Rate)) +
geom_line() +
geom_hline(aes(yintercept = mean(Savings_Rate)), linetype = "dashed", alpha = .5) +
scale_y_continuous(NULL, labels = scales::percent, limits = c(0, .115)) +
scale_x_continuous(NULL, breaks = seq(1998, 2014, by = 4)) +
ggtitle("Figure 2: National-level savings rate",
subtitle = "Temporal assessment of state-level savings rates (1997-2014)") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia"),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
data_clean %>%
filter(Location == "United States") %>%
mutate(Savings_Rate = Savings / Income) %>%
ggplot(aes(Year, Savings_Rate)) +
geom_line() +
geom_hline(aes(yintercept = mean(Savings_Rate)), linetype = "dashed", alpha = .5) +
annotate("text", x = 2010, y = .085, label = "Average: 8.6%") +
scale_y_continuous(NULL, labels = scales::percent, limits = c(0, .115)) +
scale_x_continuous(NULL, breaks = seq(1998, 2014, by = 4)) +
ggtitle("Figure 2: National-level savings rate",
subtitle = "Temporal assessment of state-level savings rates (1997-2014)") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia"),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
data_clean %>%
filter(Location == "United States") %>%
mutate(Savings_Rate = Savings / Income) %>%
ggplot(aes(Year, Savings_Rate)) +
geom_line() +
geom_hline(aes(yintercept = mean(Savings_Rate)), linetype = "dashed", alpha = .5) +
annotate("text", x = 2010, y = .085, label = "Average: 8.6%") +
scale_y_continuous(NULL, labels = scales::percent, limits = c(0, .115)) +
scale_x_continuous(NULL, breaks = seq(1998, 2014, by = 4)) +
ggtitle("Figure 2: National-level savings rate",
subtitle = "Temporal assessment of state-level savings rates (1997-2014)") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia", size = 12),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
data_clean %>%
mutate(region = tolower(Location),
Savings_Rate = Savings / Income) %>%
right_join(map_data("state")) %>%
select(-subregion) %>%
filter(Year %in% seq(1998, 2014, by = 2)) %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = Savings_Rate)) +
facet_wrap(~ Year, ncol = 3) +
scale_fill_gradient2(name = "Savings Rate", labels = scales::percent) +
ggtitle("Figure 3: Savings rate changes over time",
subtitle = "Temporal map assessment of state-level savings rates (1998-2014)") +
expand_limits() +
theme_void() +
theme(strip.text.x = element_text(size = 12),
text = element_text(family = "Georgia"),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
savings_rate <- data_clean %>%
mutate(Savings_Rate = Savings / Income) %>%
filter(Location != "United States")
top5 <- savings_rate %>%
arrange(desc(Savings_Rate)) %>%
filter(Year == 2014) %>%
slice(1:5)
bottom5 <- savings_rate %>%
arrange(Savings_Rate) %>%
filter(Year == 2014) %>%
slice(1:5)
avg <- savings_rate %>%
group_by(Year) %>%
summarise(Avg_mn = mean(Savings_Rate),
Avg_md = median(Savings_Rate)) %>%
mutate(Avg = "Average")
ggplot(savings_rate, aes(Year, Savings_Rate, group = Location)) +
geom_line(alpha = .1) +
geom_line(data = filter(savings_rate, Location %in% top5$Location),
aes(Year, Savings_Rate, group = Location), color = "dodgerblue") +
geom_line(data = filter(savings_rate, Location %in% bottom5$Location),
aes(Year, Savings_Rate, group = Location), color = "red") +
geom_line(data = avg, aes(Year, Avg_mn, group = 1), linetype = "dashed") +
annotate("text", x = 2014.25, y = .071, label = "Average", hjust = 0, size = 3) +
geom_text_repel(data = top5, aes(label = Location), nudge_x = .5, size = 3) +
geom_point(data = top5, aes(Year, Savings_Rate), color = "dodgerblue") +
geom_text_repel(data = bottom5, aes(label = Location), nudge_x = 0.5, size = 3) +
geom_point(data = bottom5, aes(Year, Savings_Rate), color = "red") +
scale_x_continuous(NULL, limits = c(1997, 2015.25), breaks = seq(1998, 2014, by = 2)) +
scale_y_continuous(NULL, labels = scales::percent) +
ggtitle("Figure 4: Savings rate changes over time",
subtitle = "Temporal assessment of state-level savings rates (1997-2014)") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
text = element_text(family = "Georgia"),
plot.title = element_text(size = 28, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)))
data_clean %>%
filter(Location == "United States") %>%
mutate(Savings_Rate = Savings / Income)
